{{> layout_start_document}}
<link rel="stylesheet" href="/public/css/project.css">
<link href="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0/css/select2.min.css" rel="stylesheet" />
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0/js/select2.min.js"></script>
<script src="/public/javascript/project.js"></script>
{{> layout_start_body}}
<main>
  <header>
    <h1 class="project-name">{{project.repoName}}</h1>
  </header>
  {{#if project}}
    <section class="project">
      <section class="controls">
        <div class="project-refs">
          <span class="project-branch">
            <label for="project-branch-select">Branch or tag:</label>
            <select title="{{project.currentBranchName}}" onchange="window.location.href = window.location.pathname + '?branch=' + this.value">
              {{#each project.tagsAndBranches}}
                <option value="{{this.urlEncodedName}}" {{#if this.current}}selected{{/if}} >{{this.name}}</option>
              {{else}}
                <option selected>No branch data found</option>
              {{/each}}
            </select>
          </span>
          <span class="project-commit">&commat;{{project.shortCommit}}</span>
        </div>
        <a href="?update=true"><button class="project-update call-to-action">Get Latest</button></a>
        <span class="repo-link"><a href="{{project.repoUrl}}">(visit&nbsp;repository)</a></span>
        <hr>
      </section>
      <section class="spec-links">
        {{#each project.filesByDir as |files directoryPath|}}
          <section>
            <h2 class="directory-path" onclick="this.classList.toggle('expand'); this.nextElementSibling.classList.toggle('hidden')">{{directoryPath}}</h2>
            <ul class="file-list">
              {{#each files}}
                {{> project_file this currentBranchName=../../project.currentBranchName}}
              {{/each}}
            </ul>
          </section>
        {{else}}
          <p>Sorry, this project does not appear to contain any specifications</p>
        {{/each}}
      </section>
    </section>
  {{else}}
    <p>Sorry, no project data was found</p>
  {{/if}}
</main>
{{> layout_end}}
